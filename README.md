# twurlrc

[![Package Version](https://badgen.net/npm/v/twurlrc)](https://npmjs.com/package/twurlrc)

Parse .twurlrc files.

[twurl] stores Twitter credentials in **~/.twurlrc** (in YAML format).
This package will parse a .twurlrc file and return credentials suitable for use with [`oauth-1.0a`][oauth].

## Install

    npm install twurlrc

## Quick Start

The [`got`][got] package provides an excellent example of how to send a signed OAuth request with [`oauth-1.0a`][oauth].
A modified version of that example is included below to illustrate how to incorporate twurlrc:

```javascript
const got = require('got');
const crypto  = require('crypto');
const OAuth = require('oauth-1.0a');
const {consumer, access_token} = require('twurlrc').fromFileSync().defaultCredentials();

const oauth = OAuth({
    consumer,
    signature_method: 'HMAC-SHA1',
    hash_function: (baseString, key) => crypto.createHmac('sha1', key).update(baseString).digest('base64')
});

const url = 'https://api.twitter.com/1.1/statuses/home_timeline.json';

got(url, {
    headers: oauth.toHeader(oauth.authorize({url, method: 'GET'}, access_token)),
    json: true
});
```

The `Twurlrc` class is used to get credentials from parsed data.

Call `Twurlrc.fromFile` or `Twurlrc.fromFileSync` to create a `Twurlrc` object
and load the contents of the specified file path.
If no path is specified **~/.twurlrc** is loaded by default.

Call `Twurlrc.fromYAMLSync` to create a `Twurlrc` object from a YAML string.

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [Twurlrc](#twurlrc)
    -   [Parameters](#parameters)
    -   [data](#data)
    -   [credentials](#credentials)
        -   [Parameters](#parameters-1)
        -   [Examples](#examples)
    -   [defaultCredentials](#defaultcredentials)
        -   [Parameters](#parameters-2)
        -   [Examples](#examples-1)
    -   [fromYAMLSync](#fromyamlsync)
        -   [Parameters](#parameters-3)
        -   [Examples](#examples-2)
    -   [fromFileSync](#fromfilesync)
        -   [Parameters](#parameters-4)
        -   [Examples](#examples-3)
    -   [fromFile](#fromfile)
        -   [Parameters](#parameters-5)
        -   [Examples](#examples-4)

### Twurlrc

Get credentials from parsed data.

#### Parameters

-   `data` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** object returned by YAML parser
    -   `data.configuration` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
        -   `data.configuration.default_profile` **[Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array)** [0]&#x3A; screen_name, [1]&#x3A; consumer_key
    -   `data.profiles` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** credentials grouped by screen_name then consumer_key

#### data

object returned by YAML parser

Type: [Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)

#### credentials

Get credentials for the specified profile.

Returns grouped key/secret pairs by default. Disable grouping by passing `true` for the `raw` parameter value.

If the `consumer_key` parameter is omitted or falsy, the "first" consumer_key defined for provided `screen_name`
is used. This fallback is provided for convenience when parsing profiles with a single consumer_key defined.
To load credentials from profiles with multiple consumer_keys defined, specifying which consumer_key to load is
strongly recommended (as opposed to relying on definition order).

##### Parameters

-   `screen_name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Twitter user screen_name
-   `consumer_key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Twitter app consumer_key
-   `raw` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** return unmodified credentials object instead of grouping key/secret pairs (optional, default `false`)

##### Examples

```javascript
// get credentials with grouped key/secret pairs
const {consumer, access_token, screen_name} = twurlrc.credentials('my_screen_name', 'my_consumer_key');
// consumer === {key: consumer_key, secret: consumer_secret}
// access_token === {key: token, secret: secret}
// screen_name === 'my_screen_name'
```

```javascript
// disable grouping
const {consumer_key, consumer_secret, token, secret, username} = twurlrc.credentials('my_screen_name', 'my_consumer_key', true);
```

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

#### defaultCredentials

Get credentials for the default profile.

Returns grouped key/secret pairs by default. Disable grouping by passing `true` for the `raw` parameter value.

##### Parameters

-   `raw` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** return unmodified credentials object instead of grouping key/secret pairs (optional, default `false`)

##### Examples

```javascript
// get default credentials with grouped key/secret pairs
const {consumer, access_token, screen_name} = twurlrc.defaultCredentials();
// consumer === {key: consumer_key, secret: consumer_secret}
// access_token === {key: token, secret: secret}
// screen_name === 'my_screen_name'
```

```javascript
// disable grouping
const {consumer_key, consumer_secret, token, secret, username} = twurlrc.defaultCredentials(true);
```

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 

#### fromYAMLSync

Create a Twurlrc object from a YAML string.

##### Parameters

-   `yaml` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** YAML string

##### Examples

```javascript
try {
    const twurlrc = require('twurlrc').fromYAMLSync('YAML STRING');
    // use twurlrc
}
 catch(error) {
    console.error(error.message);
}
```

Returns **[Twurlrc](#twurlrc)** 

#### fromFileSync

Create a Twurlrc object from a file path.

##### Parameters

-   `filePath` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** path to .twurlrc file

##### Examples

```javascript
try {
    const twurlrc = require('twurlrc').fromFileSync('/path/to/.twurlrc');
    // use twurlrc
}
 catch(error) {
    console.error(error.message);
}
```

Returns **[Twurlrc](#twurlrc)** 

#### fromFile

Asynchronously create a Twurlrc object from a file path.

##### Parameters

-   `filePath` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** path to .twurlrc file

##### Examples

```javascript
const Twurlrc = require('twurlrc');
Twurlrc.fromFile('/path/to/.twurlrc')
     .then((twurlrc) => {
         // use twurlrc
     })
     .catch((error) => console.error(error.message));
```

Returns **[Promise](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise)** 

## Development

Clone the repository and `cd` into the resulting directory.

### Install Dependencies

    npm install

### Run Tests

    npm test

Note: Tests expect a **~/.twurlrc** file to exist.
The easiest way to create one is with [twurl].

## Built With

-   [yaml]

## Contributing

Fork the repo and submit a pull request.

## Versioning

[SemVer] is used for versioning.
For the versions available, see the [tags on this repository][tags]. 

## Author

[Adam Jarret](https://atj.me)

## License

This project is licensed under the _MIT License_.
See the [LICENSE.txt][license] file for details.

[semver]: https://semver.org/

[tags]: https://github.com/adamjarret/twurlrc/tags

[license]: https://github.com/adamjarret/twurlrc/blob/master/LICENSE.txt

[twurl]: https://developer.twitter.com/en/docs/tutorials/using-twurl.html

[yaml]: https://eemeli.org/yaml/

[got]: https://github.com/sindresorhus/got#oauth

[oauth]: https://github.com/ddo/oauth-1.0a
